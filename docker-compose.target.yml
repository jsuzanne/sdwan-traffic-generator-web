# SD-WAN Traffic Generator - Target Site Configuration (Echo Server)
# This is a slimmed-down configuration for site-to-site convergence testing.

services:
  # Voice Echo Server - Standalone Target (Unified with iperf3)
  voice-echo:
    image: jsuzanne/sdwan-voice-echo:latest
    container_name: sdwan-voice-echo
    network_mode: host
    restart: unless-stopped
    environment:
      - DEBUG=True
    # Ports are mapped via host network, but we list them for clarity
    # 6100-6101/udp: Voice Calls
    # 6200/udp: Convergence tests
    # 5201/tcp: iperf3 (Bandwidth)
    # 5201/udp: iperf3 (UDP Quality Probes)
    # 8082/tcp: HTTP Target

  xfr-target:
    image: jsuzanne/xfr-target:latest
    container_name: xfr-target
    network_mode: "host"
    restart: unless-stopped
    environment:
      - XFR_PORT=9000
      - XFR_MAX_DURATION=60
      - XFR_RATE_LIMIT=2
      - XFR_ALLOW_CIDR=0.0.0.0/0
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
